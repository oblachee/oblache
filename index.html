<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Memory Chase</title>
<style>
  body { margin: 0; overflow: hidden; background: #ffeef0; font-family: sans-serif; }
  canvas { display: block; margin: 0 auto; background: #fce4ec; }
  #score { position: absolute; top: 20px; left: 20px; font-size: 24px; color: #ff4b7a; font-weight: bold; }
</style>
</head>
<body>
<div id="score">Memories: 0</div>
<canvas id="gameCanvas" width="800" height="400"></canvas>

<script>
// --- Canvas setup ---
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// --- Player setup ---
const player = {
  x: 50,
  y: 300,
  width: 40,
  height: 40,
  color: '#ff4b7a',
  speed: 5
};

// --- Game variables ---
let memoriesCollected = 0;
const memoriesToCollect = 5;
const memoryImages = [];
const memoryPositions = [];
let gameState = 'running'; // 'running' or 'boss'
const projectiles = [];
let boss = { x: 600, y: 250, width: 80, height: 80, color:'#800000', health:5 };

// --- Load memory images ---
for(let i=1;i<=memoriesToCollect;i++){
  let img = new Image();
  img.src = `memory${i}.png`; // Put your images in the same folder
  memoryImages.push(img);
  memoryPositions.push({
    x: Math.random()*600 + 100,
    y: 250
  });
}

// --- Input ---
const keys = {};
document.addEventListener('keydown', e => keys[e.code] = true);
document.addEventListener('keyup', e => keys[e.code] = false);

// Shoot projectiles
document.addEventListener('keydown', e => {
  if(gameState==='boss' && e.code==='Space'){
    projectiles.push({x: player.x+player.width, y: player.y+player.height/2, width:60, height:20, text:'CHEATER'});
  }
});

// --- Game loop ---
function update(){
  // --- Player movement ---
  if(keys['ArrowLeft'] && player.x>0) player.x -= player.speed;
  if(keys['ArrowRight'] && player.x+player.width<canvas.width) player.x += player.speed;

  // --- Collect memories ---
  if(gameState==='running'){
    for(let i=memoryPositions.length-1;i>=0;i--){
      let mem = memoryPositions[i];
      if(player.x < mem.x+30 && player.x+player.width > mem.x &&
         player.y < mem.y+30 && player.y+player.height > mem.y){
        memoryPositions.splice(i,1);
        memoriesCollected++;
        document.getElementById('score').innerText = `Memories: ${memoriesCollected}`;
        if(memoriesCollected === memoriesToCollect){
          gameState = 'boss';
          document.getElementById('score').innerText = `Boss Fight! Health: ${boss.health}`;
        }
      }
    }
  }

  // --- Boss fight ---
  if(gameState==='boss'){
    // Move boss left/right automatically
    boss.x += Math.sin(Date.now()/500)*2;

    // Update projectiles
    for(let i=projectiles.length-1;i>=0;i--){
      let p = projectiles[i];
      p.x += 7;
      // Collision with boss
      if(p.x < boss.x+boss.width && p.x+p.width > boss.x &&
         p.y < boss.y+boss.height && p.y+p.height > boss.y){
        projectiles.splice(i,1);
        boss.health--;
        document.getElementById('score').innerText = `Boss Fight! Health: ${boss.health}`;
        if(boss.health <=0){
          gameState='won';
          document.getElementById('score').innerText = `You defeated the boss! ðŸ’–`;
        }
      } else if(p.x>canvas.width){
        projectiles.splice(i,1);
      }
    }
  }
}

// --- Draw ---
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // --- Draw player ---
  ctx.fillStyle = player.color;
  ctx.fillRect(player.x, player.y, player.width, player.height);

  // --- Draw memories ---
  if(gameState==='running'){
    for(let i=0;i<memoryPositions.length;i++){
      let mem = memoryPositions[i];
      ctx.drawImage(memoryImages[i], mem.x, mem.y,30,30);
    }
  }

  // --- Draw boss ---
  if(gameState==='boss' || gameState==='won'){
    ctx.fillStyle = boss.color;
    ctx.fillRect(boss.x, boss.y, boss.width, boss.height);
  }

  // --- Draw projectiles ---
  ctx.fillStyle='#ff4b7a';
  ctx.font='20px sans-serif';
  projectiles.forEach(p => {
    ctx.fillText(p.text, p.x, p.y+15);
  });
}

// --- Main loop ---
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
