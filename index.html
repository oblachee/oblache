<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cute Game — A gift</title>
<style>
  :root{--bg:#fdeef6;--panel:#fff;--accent:#ff6b9a;--muted:#6b6b6b}
  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
  body{display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,var(--bg),#fff);padding:20px}
  .card{width:960px;max-width:100%;background:var(--panel);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,0.08);overflow:hidden;display:grid;grid-template-columns:520px 1fr;gap:0}
  .left{padding:18px;background:linear-gradient(180deg,rgba(255,255,255,0.6),transparent);display:flex;flex-direction:column;gap:12px}
  h1{margin:0;font-size:20px}
  p.tip{margin:0;color:var(--muted);font-size:13px}
  .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  label{font-size:13px;color:var(--muted)}
  input[type="text"],input[type="color"],input[type="url"]{
    border:1px solid #eee;padding:8px;border-radius:10px;background:#fafafa;
  }
  button{background:var(--accent);border:none;color:white;padding:8px 12px;border-radius:10px;font-weight:600;cursor:pointer}
  button.secondary{background:#eee;color:#333}
  .right{position:relative;padding:12px;display:flex;flex-direction:column;align-items:center;justify-content:center}
  canvas{background:linear-gradient(180deg,#fff, #fef8fb);border-radius:12px;display:block;max-width:100%;width:100%;height:580px}
  .hud{position:absolute;left:22px;top:18px;background:rgba(255,255,255,0.85);backdrop-filter:blur(4px);padding:8px 12px;border-radius:999px;display:flex;gap:10px;align-items:center;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
  .score{font-weight:700;color:var(--accent)}
  .message{position:absolute;right:22px;top:18px;background:linear-gradient(90deg,#fff,#fff0);padding:10px 14px;border-radius:10px;box-shadow:0 6px 16px rgba(0,0,0,0.06)}
  .touch-controls{display:none;gap:8px;position:absolute;bottom:22px;left:22px}
  .touch-controls button{width:56px;height:56px;border-radius:12px;font-size:18px;background:rgba(0,0,0,0.06);border:none}
  .footer{margin-top:auto;font-size:12px;color:var(--muted)}
  @media (max-width:880px){
    .card{grid-template-columns:1fr; padding-bottom:20px}
    .left{order:2}
    .right{order:1}
    canvas{height:460px}
    .touch-controls{display:flex}
  }
</style>
</head>
<body>
<div class="card" role="application" aria-label="Cute collector game">
  <div class="left">
    <h1>Make it yours — Cute game builder</h1>
    <p class="tip">Enter a name, pick a color or emoji for the character, or paste an image URL. Then press <strong>Start</strong>. Use arrow keys or WASD to move. Collect hearts for a score + surprise message!</p>

    <div style="display:flex;gap:8px;flex-wrap:wrap" class="controls">
      <label>Character name<br><input id="playerName" type="text" placeholder="e.g. Alex" value="My Love" /></label>
      <label>Color<br><input id="playerColor" type="color" value="#ff6b9a" /></label>
      <label>Emoji<br><input id="playerEmoji" type="text" maxlength="2" placeholder="?? or ??" /></label>
      <label>Or image URL<br><input id="playerImg" type="url" placeholder="https://..." /></label>
      <label>Hearts to win<br><input id="goal" type="text" value="7" style="width:72px" /></label>
      <div style="display:flex;align-items:center;gap:6px">
        <button id="startBtn">Start</button>
        <button id="resetBtn" class="secondary">Reset</button>
      </div>
    </div>

    <div class="footer">
      Tip: to personalize, put your boyfriend's name as the character name and an emoji he likes. You can replace the simple drawn sprite with an image URL.
    </div>
  </div>

  <div class="right">
    <div class="hud" role="status">Score: <span class="score" id="score">0</span></div>
    <div class="message" id="midMsg">Press Start to play!</div>
    <canvas id="game" width="640" height="480"></canvas>

    <!-- mobile touch arrows -->
    <div class="touch-controls" aria-hidden="true">
      <div style="display:flex;gap:8px;align-items:center">
        <button id="leftBtn">?</button>
        <div style="display:flex;flex-direction:column;gap:8px">
          <button id="upBtn">?</button>
          <button id="downBtn">?</button>
        </div>
        <button id="rightBtn">?</button>
      </div>
    </div>
  </div>
</div>

<script>
/* ====== Simple top-down collectible hearts game ======
   - Move with arrow keys / WASD
   - Collect hearts (score)
   - Customize character via UI
   - Small particle effects + messages
*/

const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d', { alpha: false });
let W = canvas.width, H = canvas.height;

const ui = {
  name: document.getElementById('playerName'),
  color: document.getElementById('playerColor'),
  emoji: document.getElementById('playerEmoji'),
  img: document.getElementById('playerImg'),
  startBtn: document.getElementById('startBtn'),
  resetBtn: document.getElementById('resetBtn'),
  goal: document.getElementById('goal'),
  scoreText: document.getElementById('score'),
  midMsg: document.getElementById('midMsg'),
};

let state = {
  running: false,
  score: 0,
  goal: 7,
  player: { x: 80, y: 80, r: 22, speed: 160 },
  inputs: { left:0,right:0,up:0,down:0 },
  hearts: [],
  particles: [],
  t: 0
};

function rand(min,max){ return Math.random()*(max-min)+min; }

function resizeCanvas(){
  // keep internal resolution stable while scaling via CSS for crispness
  const rect = canvas.getBoundingClientRect();
  const scale = Math.min(2, window.devicePixelRatio || 1);
  canvas.width = Math.round(rect.width * scale);
  canvas.height = Math.round(rect.height * scale);
  ctx.setTransform(scale,0,0,scale,0,0);
  W = rect.width; H = rect.height;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// spawn hearts
function spawnHeart(){
  const pad = 30;
  state.hearts.push({
    x: rand(pad, W - pad),
    y: rand(pad, H - pad),
    r: 14 + Math.random()*6,
    wobble: Math.random()*Math.PI*2
  });
}

// draw player (emoji or colored rounded character)
function drawPlayer(){
  const p = state.player;
  const cx = p.x, cy = p.y, r = p.r;
  // if image URL provided, try draw image
  const url = ui.img.value.trim();
  if (url){
    // load lazily and cache
    if (!drawPlayer.img || drawPlayer.img.src !== url){
      drawPlayer.img = new Image();
      drawPlayer.img.crossOrigin = "anonymous";
      drawPlayer.img.src = url;
    }
    if (drawPlayer.img.complete){
      ctx.save();
      ctx.beginPath();
      ctx.arc(cx,cy,r,0,Math.PI*2);
      ctx.clip();
      ctx.drawImage(drawPlayer.img, cx-r, cy-r, r*2, r*2);
      ctx.restore();
      // name text
      ctx.font = "12px system-ui, sans-serif";
      ctx.textAlign = "center"; ctx.fillStyle = "#333";
      ctx.fillText(ui.name.value.trim()||"?", cx, cy + r + 16);
      return;
    }
  }

  // else emoji
  const emoji = ui.emoji.value.trim();
  if (emoji){
    ctx.font = (r*1.6|0) + "px serif";
    ctx.textAlign = "center";
    ctx.fillText(emoji, cx, cy + r*0.35);
    ctx.font = "12px system-ui, sans-serif";
    ctx.fillStyle = "#333";
    ctx.fillText(ui.name.value.trim()||"?", cx, cy + r + 16);
    return;
  }

  // fallback drawn blob
  ctx.beginPath();
  ctx.fillStyle = ui.color.value || '#ff6b9a';
  ctx.shadowColor = 'rgba(0,0,0,0.06)';
  ctx.shadowBlur = 10;
  ctx.arc(cx,cy,r,0,Math.PI*2);
  ctx.fill();
  ctx.shadowBlur = 0;
  // eyes
  ctx.fillStyle = '#222';
  ctx.beginPath();
  ctx.ellipse(cx - r*0.35, cy - r*0.14, r*0.12, r*0.14, 0, 0, Math.PI*2);
  ctx.ellipse(cx + r*0.05, cy - r*0.14, r*0.12, r*0.14, 0, 0, Math.PI*2);
  ctx.fill();
  // smile
  ctx.beginPath();
  ctx.strokeStyle = 'rgba(0,0,0,0.25)'; ctx.lineWidth = 2;
  ctx.arc(cx - r*0.03, cy + r*0.03, r*0.35, 0.15*Math.PI, 0.85*Math.PI);
  ctx.stroke();

  ctx.font = "12px system-ui, sans-serif";
  ctx.textAlign = "center"; ctx.fillStyle = "#333";
  ctx.fillText(ui.name.value.trim()||"?", cx, cy + r + 16);
}

// draw heart pickup
function drawHeart(h){
  ctx.save();
  ctx.translate(h.x, h.y);
  h.wobble += 0.02;
  const wob = Math.sin(h.wobble) * 2;
  ctx.scale(1 + wob*0.006, 1 + wob*0.006);
  // heart shape
  ctx.beginPath();
  ctx.moveTo(0, 8);
  ctx.bezierCurveTo(0, 20, -22, 20, -22, 2);
  ctx.bezierCurveTo(-22, -16, 0, -6, 0, 2);
  ctx.bezierCurveTo(0, -6, 22, -16, 22, 2);
  ctx.bezierCurveTo(22, 20, 0, 20, 0, 8);
  ctx.fillStyle = '#ff6b9a';
  ctx.fill();
  ctx.restore();
}

// particles
function spawnParticles(x,y,color,amt=12){
  for(let i=0;i<amt;i++){
    state.particles.push({
      x,y, vx: rand(-120,120), vy: rand(-200,10), life: rand(0.5,1.1), t:0, color
    });
  }
}

// update + draw loop
let last = performance.now();
function loop(now){
  const dt = Math.min(0.05, (now - last)/1000); last = now;
  state.t += dt;
  update(dt);
  draw();
  if (state.running) requestAnimationFrame(loop);
}

function update(dt){
  // move player
  const p = state.player;
  const input = state.inputs;
  let dx = (input.right - input.left);
  let dy = (input.down - input.up);
  if (dx !== 0 || dy !== 0){
    const len = Math.hypot(dx,dy) || 1;
    dx = dx/len; dy = dy/len;
    p.x += dx * p.speed * dt;
    p.y += dy * p.speed * dt;
  } else {
    // slight friction
  }
  // bounds
  p.x = Math.max(p.r, Math.min(W - p.r, p.x));
  p.y = Math.max(p.r, Math.min(H - p.r, p.y));

  // check collisions with hearts
  for(let i=state.hearts.length-1;i>=0;i--){
    const h = state.hearts[i];
    const d = Math.hypot(h.x - p.x, h.y - p.y);
    if (d < p.r + h.r*0.6){
      // collect
      state.hearts.splice(i,1);
      state.score++;
      spawnParticles(h.x, h.y, '#ff6b9a', 18);
      ui.scoreText.textContent = state.score;
      // small message pop
      ui.midMsg.textContent = ["Yay!","Nice!","Love it!","Cute!","You got one!"][Math.floor(Math.random()*5)];
      if (state.score >= state.goal){
        winSequence();
      } else {
        spawnHeart();
      }
    }
  }

  // update particles
  for(let i=state.particles.length-1;i>=0;i--){
    const part = state.particles[i];
    part.t += dt;
    part.x += part.vx * dt;
    part.y += part.vy * dt;
    part.vy += 420 * dt;
    if (part.t > part.life) state.particles.splice(i,1);
  }
}

function draw(){
  // clear
  ctx.fillStyle = '#fff';
  ctx.fillRect(0,0,W,H);

  // background grid / cute pattern
  const gsize = 40;
  ctx.save();
  ctx.globalAlpha = 0.06;
  ctx.fillStyle = '#ffeff6';
  for(let x=0;x<W;x+=gsize){
    for(let y=0;y<H;y+=gsize){
      ctx.beginPath();
      ctx.arc(x + gsize*0.7, y + gsize*0.3, 6, 0, Math.PI*2);
      ctx.fill();
    }
  }
  ctx.restore();

  // hearts
  for(const h of state.hearts) drawHeart(h);

  // player
  drawPlayer();

  // particles
  for(const p of state.particles){
    const alpha = Math.max(0, 1 - p.t/p.life);
    ctx.globalAlpha = alpha;
    ctx.beginPath();
    ctx.arc(p.x, p.y, 3.8, 0, Math.PI*2);
    ctx.fillStyle = p.color;
    ctx.fill();
  }
  ctx.globalAlpha = 1;
}

// start/reset/win
function startGame(){
  state.running = true;
  state.score = 0;
  ui.scoreText.textContent = "0";
  ui.midMsg.textContent = "Collect " + state.goal + " hearts!";
  state.hearts = [];
  state.particles = [];
  state.player.x = W/3; state.player.y = H/2;
  // parse goal
  const g = parseInt(ui.goal.value) || 7;
  state.goal = Math.max(1, Math.min(99, g));
  for(let i=0;i<Math.max(3,state.goal);i++) spawnHeart();
  last = performance.now();
  requestAnimationFrame(loop);
}

function resetGame(){
  state.running = false;
  state.score = 0;
  state.hearts = [];
  state.particles = [];
  ui.scoreText.textContent = "0";
  ui.midMsg.textContent = "Press Start to play!";
  draw(); // render idle
}

function winSequence(){
  state.running = false;
  ui.midMsg.textContent = "You did it! ??";
  // big particle burst at player
  spawnParticles(state.player.x, state.player.y, '#ff6b9a', 60);
  // show final little note (customizable)
  setTimeout(() => {
    ui.midMsg.innerHTML = `<strong>For ${escapeHtml(ui.name.value || "You")}</strong><br>Made with ??`;
  }, 600);
}

// input handlers
window.addEventListener('keydown', e=>{
  if (e.key === 'ArrowLeft' || e.key === 'a') state.inputs.left = 1;
  if (e.key === 'ArrowRight' || e.key === 'd') state.inputs.right = 1;
  if (e.key === 'ArrowUp' || e.key === 'w') state.inputs.up = 1;
  if (e.key === 'ArrowDown' || e.key === 's') state.inputs.down = 1;
});
window.addEventListener('keyup', e=>{
  if (e.key === 'ArrowLeft' || e.key === 'a') state.inputs.left = 0;
  if (e.key === 'ArrowRight' || e.key === 'd') state.inputs.right = 0;
  if (e.key === 'ArrowUp' || e.key === 'w') state.inputs.up = 0;
  if (e.key === 'ArrowDown' || e.key === 's') state.inputs.down = 0;
});

// touch buttons
const upBtn = document.getElementById('upBtn'), downBtn = document.getElementById('downBtn'),
      leftBtn = document.getElementById('leftBtn'), rightBtn = document.getElementById('rightBtn');

function onTouchStart(dir){ state.inputs[dir]=1; }
function onTouchEnd(dir){ state.inputs[dir]=0; }
upBtn.addEventListener('touchstart', e=>{e.preventDefault(); onTouchStart('up')}); upBtn.addEventListener('touchend', e=>{e.preventDefault(); onTouchEnd('up')});
downBtn.addEventListener('touchstart', e=>{e.preventDefault(); onTouchStart('down')}); downBtn.addEventListener('touchend', e=>{e.preventDefault(); onTouchEnd('down')});
leftBtn.addEventListener('touchstart', e=>{e.preventDefault(); onTouchStart('left')}); leftBtn.addEventListener('touchend', e=>{e.preventDefault(); onTouchEnd('left')});
rightBtn.addEventListener('touchstart', e=>{e.preventDefault(); onTouchStart('right')}); rightBtn.addEventListener('touchend', e=>{e.preventDefault(); onTouchEnd('right')});

// buttons
ui.startBtn.addEventListener('click', ()=> {
  startGame();
});
ui.resetBtn.addEventListener('click', ()=> resetGame());

// small helper
function escapeHtml(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

// initial draw
resetGame();
</script>
</body>
</html>
